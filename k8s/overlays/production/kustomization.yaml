apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: crypto-wallets-production

resources:
  - ../../base

patches:
  - target:
      kind: Deployment
      name: crypto-wallets-service
    patch: |-
      - op: replace
        path: /spec/replicas
        value: 5
      - op: add
        path: /spec/template/spec/containers/0/resources/requests/memory
        value: "256Mi"
      - op: add
        path: /spec/template/spec/containers/0/resources/limits/memory
        value: "1Gi"

configMapGenerator:
  - name: wallet-service-config
    literals:
      - vault-address=https://vault.production.internal:8200
      - vault-key-id=wallet-master-key
      - redis-url=redis://redis-production:6379

# Secrets should be created separately or via external-secrets operator
# kubectl create secret generic wallet-service-secrets \
#   --from-literal=api-key=your-secret-key \
#   --from-literal=database-url=postgres://... \
#   --from-literal=vault-token=... \
#   -n crypto-wallets-production
